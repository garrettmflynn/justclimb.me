var de=Object.defineProperty;var ue=(i,e,t)=>e in i?de(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var D=(i,e,t)=>(ue(i,typeof e!="symbol"?e+"":e,t),t),B=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var c=(i,e,t)=>(B(i,e,"read from private field"),t?t.call(i):e.get(i)),g=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},m=(i,e,t,s)=>(B(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t);import"https://cdn.plot.ly/plotly-2.20.0.min.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const x=[],M=[];function he(i,e){e.add(i),i.dependencies.add(e)}function me(i){for(const e of i.dependencies)e.delete(i);i.dependencies.clear()}function U(i,e){const t=r=>{me(s),x.push(s);try{i(r)}finally{x.pop()}};e||(e=i.name);const s={name:e,execute:t,dependencies:new Set};return t(),!0}function K(i,e={}){const t=new Set,s=new Set,r=e.name,n=()=>{const l=x[x.length-1];return l&&(!t.has(l)&&e.onSubscriptionAdded&&e.onSubscriptionAdded(l.name),he(l,t)),i},o=(...l)=>{if(r){const d=M[x.length-1];d&&d!==r&&!s.has(d)&&(s.add(d),e.onDependencyAdded&&e.onDependencyAdded(d));const u=x[x.length-1];u&&r!==u.name&&!t.has(u)&&e.onDependencyAdded&&e.onDependencyAdded(u.name)}M.push(r),Array.from(t).forEach(d=>{d.execute(...l)}),M.pop()};return{get:n,set:l=>(o(i=l),i),run:o,subscriptions:t}}function pe(i,e={}){const t=K(void 0,e),s=(...o)=>t.set(i(...o));let r=!1;const n=()=>{r||(r=!0,U(s,e.name))};return e.defer||n(),e.operators?{...t,run:s,initialize:n}:t.get}function fe(i){return typeof i=="function"?"/Function("+i.toString()+")/":i}const W=i=>{if(typeof i=="string"&&i.startsWith("/Function(")&&i.endsWith(")/")){let e=i.substring(10,i.length-2);return e[0]!=="("&&e.slice(0,8)!=="function"&&e.slice(0,5)!=="class"&&(e=`function ${e}`),(0,eval)("("+e+")")}return i},ge=i=>JSON.parse(i,(e,t)=>W(t));function ye(i){var t;return typeof i=="function"?i.prototype?(t=Object.getOwnPropertyDescriptor(i,"prototype"))!=null&&t.writable?"function":"class":i.constructor.name==="AsyncFunction"?"async":"arrow":""}const k={},J=["Object","Array","Map","Set"];function q(i){var t;var e=[];if(i)do{const s=(t=i.constructor)==null?void 0:t.name,r=J.includes(s);J.includes(s)&&(k[s]||(k[s]=[...Object.getOwnPropertyNames(globalThis[s].prototype)])),Object.getOwnPropertyNames(i).forEach(function(n){n!=="constructor"&&(r&&k[s].includes(n)||e.indexOf(n)===-1&&e.push(n))})}while(i=Object.getPrototypeOf(i));return e}var S,w,p,b,P,v,T,z,O;const C=class{constructor(e={}){g(this,S,void 0);g(this,w,void 0);g(this,p,void 0);g(this,b,void 0);g(this,P,void 0);g(this,v,void 0);g(this,T,void 0);g(this,z,void 0);g(this,O,void 0);m(this,S,{}),m(this,w,{}),m(this,p,{}),m(this,b,{}),this.nodes={},this.ignore=[],this.onSubscriptionAdded=()=>{},m(this,P,(s,r)=>{let n=s,o=r;if(c(this,p).base&&(n=`${c(this,p).base}.${s}`,o=`${c(this,p).base}.${r}`),c(this,S)[s]||(c(this,S)[s]=new Set),c(this,S)[s].add(r),c(this,v).call(this,s)){for(const a in c(this,S))c(this,S)[a].has(s)&&c(this,P).call(this,a,r);return}c(this,v).call(this,r)||(c(this,w)[s]||(c(this,w)[s]=new Set),c(this,w)[s].has(r)||(c(this,w)[s].add(r),this.onSubscriptionAdded(n,o)))}),this.export=({json:s=!1}={})=>{const r={};for(const n in this.nodes)c(this,b)[n]instanceof C?r[n]=c(this,b)[n].export({json:s}):r[n]=typeof c(this,b)[n]=="function"?c(this,b)[n]:this.nodes[n],s&&(r[n]=fe(r[n]));return r},m(this,v,s=>s[0]==="$"),m(this,T,(s,r)=>{const n=typeof s=="string",o=n?s:r,a=n?r:s,l={...c(this,p),base:c(this,p).base?`${c(this,p).base}.${o}`:o},d=new C(l);c(this,b)[o]=d,d.load(a);const u={};for(const h in d.nodes)c(this,O).call(this,h,{get:()=>d.nodes[h],set:E=>d.nodes[h]=E},u);return n&&c(this,O).call(this,o,{get:()=>u}),u}),this.toJSON=()=>this.export({json:!0}),m(this,z,(s,r,n)=>pe((...o)=>s.call(this.nodes,...o),{...n,operators:!0,name:r,onDependencyAdded:o=>c(this,P).call(this,o,r)})),m(this,O,(s,r,n=this.nodes)=>(Object.defineProperty(n,s,{...r,enumerable:!0,configurable:!1}),r)),m(this,p,{...e}),Object.keys(c(this,p)).forEach(s=>{Object.defineProperty(this,s,{get:()=>c(this,p)[s],set:r=>c(this,p)[s]=r})})}get subscriptions(){const e=Object.entries(c(this,b)).filter(([s,r])=>r instanceof C),t={...c(this,w)};return e.forEach(([s,r])=>t[s]=r.subscriptions),t}add(e,t,s={}){if(!this.ignore.includes(t))if(typeof e=="object"){this.load(e);return}else{const r=e;c(this,b)[r]=t;let n={};const o=ye(t);if(o==="class"){const a=t,l=(...d)=>c(this,T).call(this,new a(...d),r);n.get=()=>l}else if(o){let a;const l=h=>a=c(this,z).call(this,h,r,s);a=l(t);const d=()=>a.get(),u=(...h)=>{const E=h.length;return E===1&&h[0]===void 0?d():E?a.run(...h):d()};n.get=()=>u,n.set=l,n.initialize=a.initialize}else{const a=K(t,{onSubscriptionAdded:l=>c(this,P).call(this,r,l)});n.get=()=>a.get(),n.set=a.set}return c(this,v).call(this,r)||(c(this,w)[r]=new Set),c(this,O).call(this,r,n)}}load(e={}){const t=typeof e=="string"?ge(e):e;return q(t).sort((r,n)=>c(this,v).call(this,r)&&!c(this,v).call(this,n)?1:!c(this,v).call(this,r)&&c(this,v).call(this,n)?-1:0).forEach(r=>{const n=t[r];n&&typeof n=="object"&&!Array.isArray(n)?c(this,T).call(this,r,n):this.add(r,W(n))}),!0}};let V=C;S=new WeakMap,w=new WeakMap,p=new WeakMap,b=new WeakMap,P=new WeakMap,v=new WeakMap,T=new WeakMap,z=new WeakMap,O=new WeakMap;var y,L;class $ extends HTMLElement{constructor(t={}){super();g(this,y,void 0);g(this,L,void 0);m(this,L,!1),this.initialize=()=>{if(c(this,L))return;const s=[];q(this).forEach(n=>{if(n==="constructor"||n==="connectedCallback"||n in HTMLElement.prototype)return;if(n in c(this,y).nodes)c(this,y).nodes[n]=this[n];else{const a=c(this,y).add(n,this[n],{defer:!0});a&&s.push(a)}});for(let n in c(this,y).nodes)Object.defineProperty(this,n,{get:()=>c(this,y).nodes[n],set:o=>c(this,y).nodes[n]=o});s.forEach(n=>n.initialize?n.initialize():void 0),m(this,L,!0)},t instanceof V?m(this,y,t):(m(this,y,new V({ignore:[this.initialize]})),c(this,y).load(t))}connectedCallback(){this.initialize();let t=this.render()??[];Array.isArray(t)||(t=[t]),t.forEach(s=>{const r=s instanceof HTMLElement;s=r?s:s.bind(this);let n;U(()=>{const o=r?s:s();o!==n&&(n?n.replaceWith(o):this.append(o),n=o)})})}render(){return[]}}y=new WeakMap,L=new WeakMap;customElements.define("commonwealth-element",$);class Q extends ${constructor(t){super(t);D(this,"body",document.createElement("div"));this.style.display="grid",this.style.gridTemplateColumns="1fr",this.style.gridTemplateRows="auto 1fr",this.style.height="100%"}nav(){const t=document.createElement("nav"),s=document.createElement("h2");s.innerText=this.header;const n=new URLSearchParams(window.location.search).get("page"),o=document.createElement("div"),a=this.pages.map(({label:l,element:d},u)=>{const h=document.createElement("a");h.style.marginLeft="15px",h.href="javascript:undefined",h.innerText=l;const E=l.toLowerCase();return h.onclick=()=>{const I=this.body.children[0];I?I.replaceWith(d):this.body.append(d),window.history.pushState({},"",`?page=${E}`)},u===0&&(s.onclick=h.onclick),E===n&&h.click(),h});return n||a[0].click(),o.append(...a),t.append(s,o),t}render(){return[this.nav,this.body]}}let be="page-component";customElements.define(be,Q);class X extends ${constructor(e){super(e),this.initialize(),this.style.touchAction="manipulation",this.addEventListener("click",()=>this.onClick(!0))}onClick(e){return this.grade}text(){const e=document.createElement("div");return e.textContent=this.grade,e}render(){return[this.text]}}let ve="button-component";customElements.define(ve,X);var Ee=new Date().getTimezoneOffset()*6e4;const A=i=>{if(!i)return[];let e=localStorage.getItem(i)||[];return Array.isArray(e)?e:JSON.parse(e)},we=()=>Array.from({length:localStorage.length},(i,e)=>localStorage.key(e)),Y=i=>{console.error("REMOVE!"),localStorage.removeItem(i)},Z=(i,e)=>localStorage.setItem(i,e),Se=i=>localStorage.getItem(i),F=(i,e)=>{localStorage.setItem(i,JSON.stringify(e))},N=()=>new Date(Date.now()-Ee).toISOString().split("T")[0],j=()=>A(N()),xe=i=>{const e=document.createElement("li"),t=document.createElement("small");t.innerText=i.timestamp;const s=document.createElement("b");return s.innerText=i.value,e.append(s,t),e.style.cursor="delete",e};function ee({entries:i,onDelete:e}){const t=document.createElement("ul");t.innerHTML="";let s=[];return i.forEach((r,n)=>{const o=xe(r),a=document.createElement("button");a.innerHTML="Delete",a.style.marginLeft="10px",a.onclick=()=>{const l=s.reduce((u,h)=>(h<n&&u++,u),0),d=i.splice(n-l,1);s.push(n),o.remove(),e(n,d,i)},o.appendChild(a),t.appendChild(o)}),t}class te extends ${constructor(t){super(t);D(this,"get",A);D(this,"latest",j());this.latest=j(),this.initialize()}add(t,s){if(t&&s){let r=A(t);r.push({value:s,timestamp:new Date().toLocaleTimeString("en-US")}),F(t,r),this.latest=j()}}addToday(t){this.add(N(),t)}list(t=[]){return ee({entries:t,onDelete:(r,n,o)=>{const a=N();o.length?F(a,o):Y(a),this.latest=j()}})}$latestList(){this.list(this.latest)}render(){return[this.list]}}let Pe="climb-history";customElements.define(Pe,te);const _=i=>i.map(s=>parseInt(s.value.slice(1))).reduce((s,r)=>s+r+1,0),se=i=>i.reduce((e,t)=>e+parseInt(t.value.slice(1)),0)/i.length,Oe="hsl(12, 100%, 69%)",$e="hsl(334, 37%, 59%)",Ae="hsl(334, 37%, 54%)",Te="hsl(356,87%,70%)",Le="hsl(356,87%,65%)",Ve="hsl(195,56%,40%)",De="hsl(195,56%,35%)",Ce="hsl(169,100%,27%)",ze="hsl(169,100%,22%)",Ie="hsl(45,99%,49%)",je="hsl(45,99%,44%)",Ne="hsl(0, 0%, 40%)",Re="hsl(0, 0%, 35%)",Me="hsl(0, 0%, 30%)",ke="hsl(0, 0%, 25%)",Fe="hsl(0, 0%, 20%)",He="hsl(0, 0%, 15%)",_e="hsl(0, 0%, 10%)",H=Object.freeze(Object.defineProperty({__proto__:null,V0:Oe,V1:$e,V10:je,V11:Ne,V12:Re,V13:Me,V14:ke,V15:Fe,V16:He,V17:_e,V2:Ae,V3:Te,V4:Le,V5:Ve,V6:De,V7:Ce,V8:ze,V9:Ie},Symbol.toStringTag,{value:"Module"})),Ge="7",R=()=>Se("gradeRange")||Ge,Be=i=>Z("gradeRange",i),f=new V;f.add("latest",[]);f.add("score",function(){return _(this.latest)});f.add("range",R());f.nodes;class ne extends ${constructor(t){super(t);D(this,"history",new te);this.initialize()}buttons(t=R()){const s=document.createElement("div");s.classList.add("grades");const n=Array.from({length:parseInt(t)+1},(l,d)=>`V${d}`).map((l,d)=>{const u=new X({grade:l});u.classList.add("grade",l),u.setAttribute("tabindex",`${d}`);const h=H[l],I=parseInt(H[l].split(",")[2].slice(0,-2).trim())<=60?"white":"black";return u.style.setProperty("--accent-color",h),u.style.setProperty("--text-color",I),Array.from({length:10},()=>`${Math.floor(30+70*Math.random())}%`).forEach((ae,le)=>{u.style.setProperty(`--random-percent-${le}`,ae)}),u}),o=new V;let a=!1;return n.forEach(l=>{o.add(`${l.grade}Clicked`,()=>{const d=l.onClick();a&&this.history.addToday(d)})}),a=!0,s.append(...n),s}score(t=[]){this.history.list(t);const s=document.createElement("div");s.classList.add("score");const r=document.createElement("h2"),n=document.createElement("small");s.append(r,n);const o=_(t);return r.innerText=o,n.innerText=t.length?`${t.length} Climbs @ V${se(t).toFixed(2)}`:"No Climbs Recorded",s}section(){const t=document.createElement("section"),s=this.buttons();return t.append(s,this.history),t}render(){return[this.score,this.section]}}let Je="score-page";customElements.define(Je,ne);const Ue="justclimb",Ke="0.0.1",We="https://github.com/garrettmflynn/justclimb.me.git",qe="Garrett Flynn <garrettmflynn@gmail.com>",Qe="AGPL-3.0-or-later",Xe={start:"npm run dev",dev:"vite",build:"vite build",lint:"eslint ."},Ye={"@typescript-eslint/eslint-plugin":"^5.43.0",eslint:"^8.0.1","eslint-config-standard-with-typescript":"^34.0.1","eslint-plugin-import":"^2.25.2","eslint-plugin-n":"^15.0.0","eslint-plugin-promise":"^6.0.0",typescript:"*",vite:"^4.2.1"},Ze={"@maverick-js/signals":"^5.10.2","solid-js":"^1.7.5"},et={name:Ue,version:Ke,private:!0,repository:We,author:qe,license:Qe,scripts:Xe,devDependencies:Ye,dependencies:Ze};class re extends ${constructor(e){super(e),this.initialize(),Be(R())}onRangeUpdate(e){return e}range(){let e=document.createElement("div");e.classList.add("slider");const t=document.createElement("small"),s=document.createElement("input");return s.type="range",s.min="0",s.max="17",s.oninput=()=>t.innerHTML=s.value,s.onchange=()=>this.onRangeUpdate(parseInt(s.value)),t.innerHTML=s.value=R(),e.append(s,t),e}version(){const e=document.createElement("small");return e.classList.add("version"),e.innerText=et.version,e}section(){const e=document.createElement("section");return e.append(this.range(),this.version()),e}render(){return this.section()}}let tt="settings-page";customElements.define(tt,re);class ie extends ${constructor(e){super(e),this.initialize()}dates(){return we().filter(e=>{try{const t=new Date(e);return t instanceof Date&&!isNaN(t)}catch{}}).sort((e,t)=>new Date(t)-new Date(e))}getSplit(e=!1){const t=e?[...this.dates()].reverse():this.dates(),s=t.map(o=>A(o));let r=[],n=s.map((o,a)=>{const l={};return o.forEach(d=>{r.includes(d.value)||r.push(d.value),d.value in l?l[d.value]++:l[d.value]=1}),l},{});return{dates:t,grades:r,split:n}}score(){const e=[...this.dates()].reverse(),t=e.map(d=>A(d)),s=t.map(_),r=t.map(d=>d.reduce((u,h)=>u+parseInt(h.value.slice(1)),0)/d.length),n={x:e,y:s,name:"Total Score",mode:"lines",line:{color:"black",width:2}},o={x:e,y:r,name:"Average Difficulty",yaxis:"y2",mode:"lines",line:{color:"darkgray",width:1}};var a={type:"scatter",mode:"lines",title:"Score Overview",xaxis:{type:"category"},yaxis:{rangemode:"tozero"},yaxis2:{overlaying:"y",side:"right",rangemode:"tozero"}};const l=document.createElement("div");return setTimeout(()=>Plotly.newPlot(l,[n,o],a,{responsive:!0}),10),l}grades(){const{grades:e,split:t,dates:s}=this.getSplit(!0),r=e.sort((a,l)=>parseInt(a.slice(1))-parseInt(l.slice(1))).map(a=>({x:s,y:t.map(l=>l[a]||0),name:a,marker:{color:H[a]},type:"bar"}));var n={barmode:"stack",title:"Grade Breakdown",xaxis:{type:"category"},yaxis:{title:"# of Climbs"}};const o=document.createElement("div");return setTimeout(()=>Plotly.newPlot(o,r,n,{responsive:!0}),10),o}onDelete(e,t=[]){return e?(t.length?F(e,t):Y(e),{date:e,entries:t}):{}}list(){const e=this.dates(),t=document.createElement("div");return t.append(...e.map(s=>{const r=A(s),n=document.createElement("div"),o=document.createElement("h3");o.style.marginBottom="0px",o.innerText=s;const a=document.createElement("small"),l=se(r);a.innerText=r.length?`${r.length} climbs @ V${l.toFixed(1)}`:"No Climbs";const d=ee({entries:r,onDelete:(u,h,E)=>this.onDelete(s,E)});return n.append(o,a,d),n})),t}render(){return[this.score,this.grades,this.list]}}let st="history-page";customElements.define(st,ie);const G=new ne,oe=new re,ce=new ie,nt=new Q({header:"JustClimb",pages:[{label:"Score",element:G},{label:"History",element:ce},{label:"Settings",element:oe}]});document.body.append(nt);f.add("scorePage",G);f.add("historyPage",ce);f.add("settingsPage",oe);f.add("$latestScoreView",function(){this.scorePage.score(this.latest)});f.add("$latestHistoryView",function(){this.historyPage.list(this.latest)});f.add("$historyScoreGlobal",function(){this.latest=G.history.latest});f.add("$rangeSliderGlobalRange",function(){this.range=this.settingsPage.onRangeUpdate()});f.add("$rangeLocalStorage",function(){this.range&&Z("gradeRange",this.range)});f.add("$rangeButtonsView",function(){this.range&&this.scorePage.buttons(this.range)});f.add("$onDeleteHistoryViewAndGlobal",function(){const i=N(),{date:e,entries:t}=this.historyPage.onDelete();e&&t&&(e===i&&(this.latest=t),this.historyPage.grades(!0),this.historyPage.score(!0))});
