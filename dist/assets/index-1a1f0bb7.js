var ue=Object.defineProperty;var he=(r,e,t)=>e in r?ue(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var A=(r,e,t)=>(he(r,typeof e!="symbol"?e+"":e,t),t),R=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var i=(r,e,t)=>(R(r,e,"read from private field"),t?t.call(r):e.get(r)),f=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},m=(r,e,t,s)=>(R(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);import"https://cdn.plot.ly/plotly-2.20.0.min.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();const S=[],k=[];function me(r,e){e.add(r),r.dependencies.add(e)}function fe(r){for(const e of r.dependencies)e.delete(r);r.dependencies.clear()}function K(r,e){const t=n=>{fe(s),S.push(s);try{r(n)}finally{S.pop()}};e||(e=r.name);const s={name:e,execute:t,dependencies:new Set};return t(),!0}function W(r,e={}){const t=new Set,s=new Set,n=e.name,o=()=>{const l=S[S.length-1];return l&&(!t.has(l)&&e.onSubscriptionAdded&&e.onSubscriptionAdded(l.name),me(l,t)),r},c=(...l)=>{if(n){const a=k[S.length-1];a&&a!==n&&!s.has(a)&&(s.add(a),e.onDependencyAdded&&e.onDependencyAdded(a));const u=S[S.length-1];u&&n!==u.name&&!t.has(u)&&e.onDependencyAdded&&e.onDependencyAdded(u.name)}k.push(n),Array.from(t).forEach(a=>{a.execute(...l)}),k.pop()};return{get:o,set:l=>(c(r=l),r),run:c,subscriptions:t}}function pe(r,e={}){const t=W(void 0,e),s=(...n)=>t.set(r(...n));return K(s,e.name),e.operators?{...t,run:s}:t.get}function ge(r){return typeof r=="function"?"/Function("+r.toString()+")/":r}const U=r=>{if(typeof r=="string"&&r.startsWith("/Function(")&&r.endsWith(")/")){let e=r.substring(10,r.length-2);return e[0]!=="("&&e.slice(0,8)!=="function"&&e.slice(0,5)!=="class"&&(e=`function ${e}`),(0,eval)("("+e+")")}return r},ye=r=>JSON.parse(r,(e,t)=>U(t));function be(r){var t;return typeof r=="function"?r.prototype?(t=Object.getOwnPropertyDescriptor(r,"prototype"))!=null&&t.writable?"function":"class":r.constructor.name==="AsyncFunction"?"async":"arrow":""}const z={},G=["Object","Array","Map","Set"];function q(r){var t;var e=[];if(r)do{const s=(t=r.constructor)==null?void 0:t.name,n=G.includes(s);G.includes(s)&&(z[s]||(z[s]=[...Object.getOwnPropertyNames(globalThis[s].prototype)])),Object.getOwnPropertyNames(r).forEach(function(o){o!=="constructor"&&(n&&z[s].includes(o)||e.indexOf(o)===-1&&e.push(o))})}while(r=Object.getPrototypeOf(r));return e}var w,E,p,y,x,b,$,I,O;const V=class{constructor(e={}){f(this,w,void 0);f(this,E,void 0);f(this,p,void 0);f(this,y,void 0);f(this,x,void 0);f(this,b,void 0);f(this,$,void 0);f(this,I,void 0);f(this,O,void 0);m(this,w,{}),m(this,E,{}),m(this,p,{}),m(this,y,{}),this.nodes={},this.ignore=[],this.onSubscriptionAdded=()=>{},m(this,x,(s,n)=>{let o=s,c=n;if(i(this,p).base&&(o=`${i(this,p).base}.${s}`,c=`${i(this,p).base}.${n}`),i(this,w)[s]||(i(this,w)[s]=new Set),i(this,w)[s].add(n),i(this,b).call(this,s)){for(const d in i(this,w))i(this,w)[d].has(s)&&i(this,x).call(this,d,n);return}i(this,b).call(this,n)||(i(this,E)[s]||(i(this,E)[s]=new Set),i(this,E)[s].has(n)||(i(this,E)[s].add(n),this.onSubscriptionAdded(o,c)))}),this.export=({json:s=!1}={})=>{const n={};for(const o in this.nodes)i(this,y)[o]instanceof V?n[o]=i(this,y)[o].export({json:s}):n[o]=typeof i(this,y)[o]=="function"?i(this,y)[o]:this.nodes[o],s&&(n[o]=ge(n[o]));return n},m(this,b,s=>s[0]==="$"),m(this,$,(s,n)=>{const o=typeof s=="string",c=o?s:n,d=o?n:s,l={...i(this,p),base:i(this,p).base?`${i(this,p).base}.${c}`:c},a=new V(l);i(this,y)[c]=a,a.load(d);const u={};for(const h in a.nodes)i(this,O).call(this,h,{get:()=>a.nodes[h],set:v=>a.nodes[h]=v},u);return o&&i(this,O).call(this,c,{get:()=>u}),u}),this.toJSON=()=>this.export({json:!0}),m(this,I,(s,n)=>pe((...o)=>s.call(this.nodes,...o),{operators:!0,name:n,onDependencyAdded:o=>i(this,x).call(this,o,n)})),m(this,O,(s,n,o=this.nodes)=>(Object.defineProperty(o,s,{...n,enumerable:!0,configurable:!1}),n)),m(this,p,{...e}),Object.keys(i(this,p)).forEach(s=>{Object.defineProperty(this,s,{get:()=>i(this,p)[s],set:n=>i(this,p)[s]=n})})}get subscriptions(){const e=Object.entries(i(this,y)).filter(([s,n])=>n instanceof V),t={...i(this,E)};return e.forEach(([s,n])=>t[s]=n.subscriptions),t}add(e,t){if(!this.ignore.includes(t)){if(typeof e=="object")return this.load(e);{const s=e;i(this,y)[s]=t;let n={};const o=be(t);if(o==="class"){const c=t,d=(...l)=>i(this,$).call(this,new c(...l),s);n.get=()=>d}else if(o){let c;const d=u=>c=i(this,I).call(this,u,s);d(t);const l=()=>c.get(),a=(...u)=>{const h=u.length;return h===1&&u[0]===void 0?l():h?c.run(...u):l()};n.get=()=>a,n.set=d}else{const c=W(t,{onSubscriptionAdded:d=>i(this,x).call(this,s,d)});n.get=()=>c.get(),n.set=c.set}return i(this,b).call(this,s)||(i(this,E)[s]=new Set),i(this,O).call(this,s,n)}}}load(e={}){const t=typeof e=="string"?ye(e):e;return q(t).sort((n,o)=>i(this,b).call(this,n)&&!i(this,b).call(this,o)?1:!i(this,b).call(this,n)&&i(this,b).call(this,o)?-1:0).forEach(n=>{const o=t[n];o&&typeof o=="object"&&!Array.isArray(o)?i(this,$).call(this,n,o):this.add(n,U(o))}),!0}};let C=V;w=new WeakMap,E=new WeakMap,p=new WeakMap,y=new WeakMap,x=new WeakMap,b=new WeakMap,$=new WeakMap,I=new WeakMap,O=new WeakMap;var g,L;class P extends HTMLElement{constructor(t={}){super();f(this,g,void 0);f(this,L,void 0);m(this,L,!1),this.initialize=()=>{if(i(this,L))return;q(this).forEach(n=>{if(n==="constructor"||n==="connectedCallback"||n in HTMLElement.prototype)return;n in i(this,g).nodes?i(this,g).nodes[n]=this[n]:i(this,g).add(n,this[n])});for(let n in i(this,g).nodes)Object.defineProperty(this,n,{get:()=>i(this,g).nodes[n],set:o=>i(this,g).nodes[n]=o});m(this,L,!0)},t instanceof C?m(this,g,t):(m(this,g,new C({ignore:[this.initialize]})),i(this,g).load(t))}connectedCallback(){this.initialize();let t=this.render()??[];Array.isArray(t)||(t=[t]),t.forEach(s=>{s=s.bind(this);let n;K(()=>{const o=s();o!==n&&(n?n.replaceWith(o):this.append(o),n=o)})})}render(){return[]}}g=new WeakMap,L=new WeakMap;customElements.define("commonwealth-element",P);var N;class Q extends P{constructor(t){super(t);f(this,N,document.createElement("div"));A(this,"body",()=>i(this,N));this.style.display="grid",this.style.gridTemplateColumns="1fr",this.style.gridTemplateRows="auto 1fr",this.style.height="100vh"}nav(){const t=document.createElement("nav"),s=document.createElement("h2");s.innerText=this.header;const o=new URLSearchParams(window.location.search).get("page"),c=document.createElement("div"),d=this.pages.map(({label:l,element:a},u)=>{const h=document.createElement("a");h.style.marginLeft="15px",h.href="javascript:undefined",h.innerText=l;const v=l.toLowerCase();return h.onclick=()=>{const M=this.body(),j=M.children[0];j?j.replaceWith(a):M.append(a),window.history.pushState({},"",`?page=${v}`)},u===0&&(s.onclick=h.onclick),v===o&&h.click(),h});return o||d[0].click(),c.append(...d),t.append(s,c),t}render(){return[this.nav,this.body]}}N=new WeakMap;let Ee="page-component";customElements.define(Ee,Q);class X extends P{constructor(e){super(e),this.initialize(),this.style.touchAction="manipulation",this.addEventListener("click",()=>this.onClick(!0))}onClick(e){return this.grade}text(){const e=document.createElement("div");return e.textContent=this.grade,e}render(){return[this.text]}}let ve="button-component";customElements.define(ve,X);var we=new Date().getTimezoneOffset()*6e4;const T=r=>{if(!r)return[];let e=localStorage.getItem(r)||[];return Array.isArray(e)?e:JSON.parse(e)},Se=()=>Array.from({length:localStorage.length},(r,e)=>localStorage.key(e)),Y=r=>{console.error("REMOVE!"),localStorage.removeItem(r)},Z=(r,e)=>localStorage.setItem(r,e),ee=r=>localStorage.getItem(r),F=(r,e)=>{localStorage.setItem(r,JSON.stringify(e))},_=()=>new Date(Date.now()-we).toISOString().split("T")[0],J=()=>T(_()),xe=r=>{const e=document.createElement("li"),t=document.createElement("small");t.innerText=r.timestamp;const s=document.createElement("b");return s.innerText=r.value,e.append(s,t),e.style.cursor="delete",e};function te({entries:r,onDelete:e}){const t=document.createElement("ul");t.innerHTML="";let s=[];return r.forEach((n,o)=>{const c=xe(n),d=document.createElement("button");d.innerHTML="Delete",d.style.marginLeft="10px",d.onclick=()=>{const l=s.reduce((u,h)=>(h<o&&u++,u),0),a=r.splice(o-l,1);s.push(o),c.remove(),e(o,a,r)},c.appendChild(d),t.appendChild(c)}),t}class se extends P{constructor(t){super(t);A(this,"get",T);A(this,"latest",[]);this.latest=J()}add(t,s){if(t&&s){let n=T(t);n.push({value:s,timestamp:new Date().toLocaleTimeString("en-US")}),F(t,n),this.list(!0)}}addToday(t){this.add(_(),t)}list(t){const s=_(),n=this.latest=J();return te({entries:n,onDelete:(c,d,l)=>{l.length?F(s,l):Y(s),this.list(!0)}})}render(){return[this.list]}}let Oe="climb-history";customElements.define(Oe,se);const ne=r=>r.map(s=>parseInt(s.value.slice(1))).reduce((s,n)=>s+n+1,0),re=r=>r.reduce((e,t)=>e+parseInt(t.value.slice(1)),0)/r.length,oe="7",B=()=>ee("gradeRange")||oe,Pe=r=>Z("gradeRange",r);class ie extends P{constructor(e){super(e),Pe(B())}range(){let e=document.createElement("div");e.classList.add("slider");const t=document.createElement("small"),s=document.createElement("input");return s.type="range",s.min="0",s.max="17",s.oninput=()=>{t.innerHTML=s.value,Z("gradeRange",s.value)},s.onchange=()=>window.location.reload(),t.innerHTML=s.value=B(),e.append(s,t),e}render(){return[this.range]}}let Ae="settings-page";customElements.define(Ae,ie);const Te="hsl(12, 100%, 69%)",$e="hsl(334, 37%, 59%)",Le="hsl(334, 37%, 59%)",Ve="hsl(356,87%,70%)",Ce="hsl(356,87%,70%)",Ie="hsl(195,56%,40%)",De="hsl(195,56%,40%)",je="hsl(169,100%,27%)",Ne="hsl(169,100%,27%)",Me="hsl(45,99%,49%)",ke="hsl(45,99%,49%)",ze="hsl(0, 0%, 40%)",Fe="hsl(0, 0%, 35%)",_e="hsl(0, 0%, 30%)",He="hsl(0, 0%, 25%)",Re="hsl(0, 0%, 20%)",Ge="hsl(0, 0%, 15%)",Je="hsl(0, 0%, 10%)",H=Object.freeze(Object.defineProperty({__proto__:null,V0:Te,V1:$e,V10:ke,V11:ze,V12:Fe,V13:_e,V14:He,V15:Re,V16:Ge,V17:Je,V2:Le,V3:Ve,V4:Ce,V5:Ie,V6:De,V7:je,V8:Ne,V9:Me},Symbol.toStringTag,{value:"Module"}));var D;class ce extends P{constructor(t){super(t);f(this,D,new se);A(this,"history",()=>i(this,D));A(this,"buttons",()=>{let t=ee("gradeRange")||oe;const s=document.createElement("div");s.classList.add("grades");const o=Array.from({length:parseInt(t)+1},(a,u)=>`V${u}`).map((a,u)=>{const h=new X({grade:a});h.classList.add("grade",a),h.setAttribute("tabindex",`${u}`);const v=H[a],j=parseInt(H[a].split(",")[2].slice(0,-2).trim())<=60?"white":"black";return h.style.setProperty("--accent-color",v),h.style.setProperty("--text-color",j),Array.from({length:10},()=>`${Math.floor(30+70*Math.random())}%`).forEach((le,de)=>{h.style.setProperty(`--random-percent-${de}`,le)}),h}),c=new C;let d=!1;const l=this.history();return o.forEach(a=>{c.add(`${a.grade}Clicked`,()=>{const u=a.onClick();d&&l.addToday(u)})}),d=!0,s.append(...o),s});i(this,D).initialize()}score(){const t=document.createElement("div");t.classList.add("score");const s=document.createElement("h2"),n=document.createElement("small");t.append(s,n);const{latest:o}=this.history(),c=ne(o);return s.innerText=`${c}`,n.innerText=`${o.length} Climbs @ V${re(o).toFixed(2)}`,t}section(){const t=document.createElement("section"),s=this.buttons(),n=this.history();return t.append(s,n),t}render(){return[this.score,this.section]}}D=new WeakMap;let Be="score-page";customElements.define(Be,ce);class ae extends P{constructor(e){super(e)}dates(){return Se().filter(e=>{try{const t=new Date(e);return t instanceof Date&&!isNaN(t)}catch{}}).sort((e,t)=>new Date(t)-new Date(e))}getSplit(e=!1){const t=e?[...this.dates()].reverse():this.dates(),s=t.map(c=>T(c));let n=[],o=s.map((c,d)=>{const l={};return c.forEach(a=>{n.includes(a.value)||n.push(a.value),a.value in l?l[a.value]++:l[a.value]=1}),l},{});return{dates:t,grades:n,split:o}}score(){const e=[...this.dates()].reverse(),t=e.map(a=>T(a)),s=t.map(ne),n=t.map(a=>a.reduce((u,h)=>u+parseInt(h.value.slice(1)),0)/a.length),o={x:e,y:s,name:"Total Score",mode:"lines",line:{color:"black",width:2}},c={x:e,y:n,name:"Average Difficulty",yaxis:"y2",mode:"lines",line:{color:"darkgray",width:1}};var d={type:"scatter",mode:"lines",title:"Score Overview",xaxis:{type:"category"},yaxis:{rangemode:"tozero"},yaxis2:{overlaying:"y",side:"right",rangemode:"tozero"}};const l=document.createElement("div");return setTimeout(()=>Plotly.newPlot(l,[o,c],d,{responsive:!0}),10),l}grades(){const{grades:e,split:t,dates:s}=this.getSplit(!0),n=e.sort((d,l)=>parseInt(d.slice(1))-parseInt(l.slice(1))).map(d=>({x:s,y:t.map(l=>l[d]||0),name:d,marker:{color:H[d]},type:"bar"}));var o={barmode:"stack",title:"Grade Breakdown",xaxis:{type:"category"},yaxis:{title:"# of Climbs"}};const c=document.createElement("div");return setTimeout(()=>Plotly.newPlot(c,n,o,{responsive:!0}),10),c}list(){const e=this.dates(),t=document.createElement("div");return t.append(...e.map(s=>{const n=T(s),o=document.createElement("div"),c=document.createElement("h3");c.style.marginBottom="0px",c.innerText=s;const d=document.createElement("small"),l=re(n);d.innerText=n.length?`${n.length} climbs @ V${l.toFixed(1)}`:"No Climbs";const a=te({entries:n,onDelete:(u,h,v)=>{v.length?F(s,v):Y(s)}});return o.append(c,d,a),o})),t}render(){return[this.score,this.grades,this.list]}}let Ke="history-page";customElements.define(Ke,ae);const We=new ce,Ue=new ie,qe=new ae,Qe=new Q({header:"JustClimb",pages:[{label:"Score",element:We},{label:"History",element:qe},{label:"Settings",element:Ue}]});document.body.append(Qe);
