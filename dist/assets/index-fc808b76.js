var de=Object.defineProperty;var ue=(o,e,t)=>e in o?de(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var C=(o,e,t)=>(ue(o,typeof e!="symbol"?e+"":e,t),t),B=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var c=(o,e,t)=>(B(o,e,"read from private field"),t?t.call(o):e.get(o)),g=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)},m=(o,e,t,s)=>(B(o,e,"write to private field"),s?s.call(o,t):e.set(o,t),t);import"https://cdn.plot.ly/plotly-2.20.0.min.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const x=[],M=[];function he(o,e){e.add(o),o.dependencies.add(e)}function me(o){for(const e of o.dependencies)e.delete(o);o.dependencies.clear()}function U(o,e){const t=r=>{me(s),x.push(s);try{o(r)}finally{x.pop()}};e||(e=o.name);const s={name:e,execute:t,dependencies:new Set};return t(),!0}function K(o,e={}){const t=new Set,s=new Set,r=e.name,n=()=>{const l=x[x.length-1];return l&&(!t.has(l)&&e.onSubscriptionAdded&&e.onSubscriptionAdded(l.name),he(l,t)),o},i=(...l)=>{if(r){const d=M[x.length-1];d&&d!==r&&!s.has(d)&&(s.add(d),e.onDependencyAdded&&e.onDependencyAdded(d));const u=x[x.length-1];u&&r!==u.name&&!t.has(u)&&e.onDependencyAdded&&e.onDependencyAdded(u.name)}M.push(r),Array.from(t).forEach(d=>{d.execute(...l)}),M.pop()};return{get:n,set:l=>(i(o=l),o),run:i,subscriptions:t}}function fe(o,e={}){const t=K(void 0,e),s=(...i)=>t.set(o(...i));let r=!1;const n=()=>{r||(r=!0,U(s,e.name))};return e.defer||n(),e.operators?{...t,run:s,initialize:n}:t.get}function pe(o){return typeof o=="function"?"/Function("+o.toString()+")/":o}const W=o=>{if(typeof o=="string"&&o.startsWith("/Function(")&&o.endsWith(")/")){let e=o.substring(10,o.length-2);return e[0]!=="("&&e.slice(0,8)!=="function"&&e.slice(0,5)!=="class"&&(e=`function ${e}`),(0,eval)("("+e+")")}return o},ge=o=>JSON.parse(o,(e,t)=>W(t));function ye(o){var t;return typeof o=="function"?o.prototype?(t=Object.getOwnPropertyDescriptor(o,"prototype"))!=null&&t.writable?"function":"class":o.constructor.name==="AsyncFunction"?"async":"arrow":""}const k={},J=["Object","Array","Map","Set"];function q(o){var t;var e=[];if(o)do{const s=(t=o.constructor)==null?void 0:t.name,r=J.includes(s);J.includes(s)&&(k[s]||(k[s]=[...Object.getOwnPropertyNames(globalThis[s].prototype)])),Object.getOwnPropertyNames(o).forEach(function(n){n!=="constructor"&&(r&&k[s].includes(n)||e.indexOf(n)===-1&&e.push(n))})}while(o=Object.getPrototypeOf(o));return e}var v,S,f,b,P,E,T,z,O;const D=class{constructor(e={}){g(this,v,void 0);g(this,S,void 0);g(this,f,void 0);g(this,b,void 0);g(this,P,void 0);g(this,E,void 0);g(this,T,void 0);g(this,z,void 0);g(this,O,void 0);m(this,v,{}),m(this,S,{}),m(this,f,{}),m(this,b,{}),this.nodes={},this.ignore=[],this.onSubscriptionAdded=()=>{},m(this,P,(s,r)=>{let n=s,i=r;if(c(this,f).base&&(n=`${c(this,f).base}.${s}`,i=`${c(this,f).base}.${r}`),c(this,v)[s]||(c(this,v)[s]=new Set),c(this,v)[s].add(r),c(this,E).call(this,s)){for(const a in c(this,v))c(this,v)[a].has(s)&&c(this,P).call(this,a,r);return}c(this,E).call(this,r)||(c(this,S)[s]||(c(this,S)[s]=new Set),c(this,S)[s].has(r)||(c(this,S)[s].add(r),this.onSubscriptionAdded(n,i)))}),this.export=({json:s=!1}={})=>{const r={};for(const n in this.nodes)c(this,b)[n]instanceof D?r[n]=c(this,b)[n].export({json:s}):r[n]=typeof c(this,b)[n]=="function"?c(this,b)[n]:this.nodes[n],s&&(r[n]=pe(r[n]));return r},m(this,E,s=>s[0]==="$"),m(this,T,(s,r)=>{const n=typeof s=="string",i=n?s:r,a=n?r:s,l={...c(this,f),base:c(this,f).base?`${c(this,f).base}.${i}`:i},d=new D(l);c(this,b)[i]=d,d.load(a);const u={};for(const h in d.nodes)c(this,O).call(this,h,{get:()=>d.nodes[h],set:w=>d.nodes[h]=w},u);return n&&c(this,O).call(this,i,{get:()=>u}),u}),this.toJSON=()=>this.export({json:!0}),m(this,z,(s,r,n)=>fe((...i)=>s.call(this.nodes,...i),{...n,operators:!0,name:r,onDependencyAdded:i=>c(this,P).call(this,i,r)})),m(this,O,(s,r,n=this.nodes)=>(Object.defineProperty(n,s,{...r,enumerable:!0,configurable:!1}),r)),m(this,f,{...e}),Object.keys(c(this,f)).forEach(s=>{Object.defineProperty(this,s,{get:()=>c(this,f)[s],set:r=>c(this,f)[s]=r})})}get subscriptions(){const e=Object.entries(c(this,b)).filter(([s,r])=>r instanceof D),t={...c(this,S)};return e.forEach(([s,r])=>t[s]=r.subscriptions),t}add(e,t,s={}){if(!this.ignore.includes(t))if(typeof e=="object"){this.load(e);return}else{const r=e;c(this,b)[r]=t;let n={};const i=ye(t);if(i==="class"){const a=t,l=(...d)=>c(this,T).call(this,new a(...d),r);n.get=()=>l}else if(i){let a;const l=h=>a=c(this,z).call(this,h,r,s);a=l(t);const d=()=>a.get(),u=(...h)=>{const w=h.length;return w===1&&h[0]===void 0?d():w?a.run(...h):d()};n.get=()=>u,n.set=l,n.initialize=a.initialize}else{const a=K(t,{onSubscriptionAdded:l=>c(this,P).call(this,r,l)});n.get=()=>a.get(),n.set=a.set}return c(this,E).call(this,r)||(c(this,S)[r]=new Set),c(this,O).call(this,r,n)}}load(e={}){const t=typeof e=="string"?ge(e):e;return q(t).sort((r,n)=>c(this,E).call(this,r)&&!c(this,E).call(this,n)?1:!c(this,E).call(this,r)&&c(this,E).call(this,n)?-1:0).forEach(r=>{const n=t[r];n&&typeof n=="object"&&!Array.isArray(n)?c(this,T).call(this,r,n):this.add(r,W(n))}),!0}};let V=D;v=new WeakMap,S=new WeakMap,f=new WeakMap,b=new WeakMap,P=new WeakMap,E=new WeakMap,T=new WeakMap,z=new WeakMap,O=new WeakMap;var y,L;class $ extends HTMLElement{constructor(t={}){super();g(this,y,void 0);g(this,L,void 0);m(this,L,!1),this.initialize=()=>{if(c(this,L))return;const s=[];q(this).forEach(n=>{if(n==="constructor"||n==="connectedCallback"||n in HTMLElement.prototype)return;if(n in c(this,y).nodes)c(this,y).nodes[n]=this[n];else{const a=c(this,y).add(n,this[n],{defer:!0});a&&s.push(a)}});for(let n in c(this,y).nodes)Object.defineProperty(this,n,{get:()=>c(this,y).nodes[n],set:i=>c(this,y).nodes[n]=i});s.forEach(n=>n.initialize?n.initialize():void 0),m(this,L,!0)},t instanceof V?m(this,y,t):(m(this,y,new V({ignore:[this.initialize]})),c(this,y).load(t))}connectedCallback(){this.initialize();let t=this.render()??[];Array.isArray(t)||(t=[t]),t.forEach(s=>{const r=s instanceof HTMLElement;s=r?s:s.bind(this);let n;U(()=>{const i=r?s:s();i!==n&&(n?n.replaceWith(i):this.append(i),n=i)})})}render(){return[]}}y=new WeakMap,L=new WeakMap;customElements.define("commonwealth-element",$);class Q extends ${constructor(t){super(t);C(this,"body",document.createElement("div"));this.style.display="grid",this.style.gridTemplateColumns="1fr",this.style.gridTemplateRows="auto 1fr",this.style.height="100%"}nav(){const t=document.createElement("nav"),s=document.createElement("h2");s.innerText=this.header;const n=new URLSearchParams(window.location.search).get("page"),i=document.createElement("div"),a=this.pages.map(({label:l,element:d},u)=>{const h=document.createElement("a");h.style.marginLeft="15px",h.href="javascript:undefined",h.innerText=l;const w=l.toLowerCase();return h.onclick=()=>{const I=this.body.children[0];I?I.replaceWith(d):this.body.append(d),window.history.pushState({},"",`?page=${w}`)},u===0&&(s.onclick=h.onclick),w===n&&h.click(),h});return n||a[0].click(),i.append(...a),t.append(s,i),t}render(){return[this.nav,this.body]}}let be="page-component";customElements.define(be,Q);class X extends ${constructor(e){super(e),this.initialize(),this.style.touchAction="manipulation",this.addEventListener("click",()=>this.onClick(!0))}onClick(e){return this.grade}text(){const e=document.createElement("div");return e.textContent=this.grade,e}render(){return[this.text]}}let Ee="button-component";customElements.define(Ee,X);var we=new Date().getTimezoneOffset()*6e4;const A=o=>{if(!o)return[];let e=localStorage.getItem(o)||[];return Array.isArray(e)?e:JSON.parse(e)},Se=()=>Array.from({length:localStorage.length},(o,e)=>localStorage.key(e)),Y=o=>{console.error("REMOVE!"),localStorage.removeItem(o)},Z=(o,e)=>localStorage.setItem(o,e),ve=o=>localStorage.getItem(o),H=(o,e)=>{localStorage.setItem(o,JSON.stringify(e))},R=()=>new Date(Date.now()-we).toISOString().split("T")[0],N=()=>A(R()),xe=o=>{const e=document.createElement("li"),t=document.createElement("small");t.innerText=o.timestamp;const s=document.createElement("b");return s.innerText=o.value,e.append(s,t),e.style.cursor="delete",e};function ee({entries:o,onDelete:e}){const t=document.createElement("ul");t.innerHTML="";let s=[];return o.forEach((r,n)=>{const i=xe(r),a=document.createElement("button");a.innerHTML="Delete",a.style.marginLeft="10px",a.onclick=()=>{const l=s.reduce((u,h)=>(h<n&&u++,u),0),d=o.splice(n-l,1);s.push(n),i.remove(),e(n,d,o)},i.appendChild(a),t.appendChild(i)}),t}class te extends ${constructor(t){super(t);C(this,"get",A);C(this,"latest",N());this.latest=N(),this.initialize()}add(t,s){if(t&&s){let r=A(t);r.push({value:s,timestamp:new Date().toLocaleTimeString("en-US")}),H(t,r),this.latest=N()}}addToday(t){this.add(R(),t)}list(t=[]){return ee({entries:t,onDelete:(r,n,i)=>{const a=R();i.length?H(a,i):Y(a),this.latest=N()}})}$latestList(){this.list(this.latest)}render(){return[this.list]}}let Pe="climb-history";customElements.define(Pe,te);const _=o=>o.map(s=>parseInt(s.value.slice(1))).reduce((s,r)=>s+r+1,0),se=o=>o.reduce((e,t)=>e+parseInt(t.value.slice(1)),0)/o.length,Oe="hsl(12, 100%, 69%)",$e="hsl(334, 37%, 59%)",Ae="hsl(334, 37%, 54%)",Te="hsl(356,87%,70%)",Le="hsl(356,87%,65%)",Ve="hsl(195,56%,40%)",Ce="hsl(195,56%,35%)",De="hsl(169,100%,27%)",ze="hsl(169,100%,22%)",Ie="hsl(45,99%,49%)",Ne="hsl(45,99%,44%)",Re="hsl(0, 0%, 40%)",je="hsl(0, 0%, 35%)",Me="hsl(0, 0%, 30%)",ke="hsl(0, 0%, 25%)",He="hsl(0, 0%, 20%)",Fe="hsl(0, 0%, 15%)",_e="hsl(0, 0%, 10%)",F=Object.freeze(Object.defineProperty({__proto__:null,V0:Oe,V1:$e,V10:Ne,V11:Re,V12:je,V13:Me,V14:ke,V15:He,V16:Fe,V17:_e,V2:Ae,V3:Te,V4:Le,V5:Ve,V6:Ce,V7:De,V8:ze,V9:Ie},Symbol.toStringTag,{value:"Module"})),Ge="7",j=()=>ve("gradeRange")||Ge,Be=o=>Z("gradeRange",o),p=new V;p.add("latest",[]);p.add("score",function(){return _(this.latest)});p.add("range",j());p.nodes;class ne extends ${constructor(t){super(t);C(this,"history",new te);this.initialize()}buttons(t=j()){const s=document.createElement("div");s.classList.add("grades");const n=Array.from({length:parseInt(t)+1},(l,d)=>`V${d}`).map((l,d)=>{const u=new X({grade:l});u.classList.add("grade",l),u.setAttribute("tabindex",`${d}`);const h=F[l],I=parseInt(F[l].split(",")[2].slice(0,-2).trim())<=60?"white":"black";return u.style.setProperty("--accent-color",h),u.style.setProperty("--text-color",I),Array.from({length:10},()=>`${Math.floor(30+70*Math.random())}%`).forEach((ae,le)=>{u.style.setProperty(`--random-percent-${le}`,ae)}),u}),i=new V;let a=!1;return n.forEach(l=>{i.add(`${l.grade}Clicked`,()=>{const d=l.onClick();a&&this.history.addToday(d)})}),a=!0,s.append(...n),s}score(t=[]){this.history.list(t);const s=document.createElement("div");s.classList.add("score");const r=document.createElement("h2"),n=document.createElement("small");s.append(r,n);const i=_(t);return r.innerText=i,n.innerText=t.length?`${t.length} Climbs @ V${se(t).toFixed(2)}`:"No Climbs Recorded",s}section(){const t=document.createElement("section"),s=this.buttons();return t.append(s,this.history),t}render(){return[this.score,this.section]}}let Je="score-page";customElements.define(Je,ne);class re extends ${constructor(e){super(e),this.initialize(),Be(j())}onRangeUpdate(e){return e}range(){let e=document.createElement("div");e.classList.add("slider");const t=document.createElement("small"),s=document.createElement("input");return s.type="range",s.min="0",s.max="17",s.oninput=()=>t.innerHTML=s.value,s.onchange=()=>this.onRangeUpdate(parseInt(s.value)),t.innerHTML=s.value=j(),e.append(s,t),e}render(){return[this.range]}}let Ue="settings-page";customElements.define(Ue,re);class oe extends ${constructor(e){super(e),this.initialize()}dates(){return Se().filter(e=>{try{const t=new Date(e);return t instanceof Date&&!isNaN(t)}catch{}}).sort((e,t)=>new Date(t)-new Date(e))}getSplit(e=!1){const t=e?[...this.dates()].reverse():this.dates(),s=t.map(i=>A(i));let r=[],n=s.map((i,a)=>{const l={};return i.forEach(d=>{r.includes(d.value)||r.push(d.value),d.value in l?l[d.value]++:l[d.value]=1}),l},{});return{dates:t,grades:r,split:n}}score(){const e=[...this.dates()].reverse(),t=e.map(d=>A(d)),s=t.map(_),r=t.map(d=>d.reduce((u,h)=>u+parseInt(h.value.slice(1)),0)/d.length),n={x:e,y:s,name:"Total Score",mode:"lines",line:{color:"black",width:2}},i={x:e,y:r,name:"Average Difficulty",yaxis:"y2",mode:"lines",line:{color:"darkgray",width:1}};var a={type:"scatter",mode:"lines",title:"Score Overview",xaxis:{type:"category"},yaxis:{rangemode:"tozero"},yaxis2:{overlaying:"y",side:"right",rangemode:"tozero"}};const l=document.createElement("div");return setTimeout(()=>Plotly.newPlot(l,[n,i],a,{responsive:!0}),10),l}grades(){const{grades:e,split:t,dates:s}=this.getSplit(!0),r=e.sort((a,l)=>parseInt(a.slice(1))-parseInt(l.slice(1))).map(a=>({x:s,y:t.map(l=>l[a]||0),name:a,marker:{color:F[a]},type:"bar"}));var n={barmode:"stack",title:"Grade Breakdown",xaxis:{type:"category"},yaxis:{title:"# of Climbs"}};const i=document.createElement("div");return setTimeout(()=>Plotly.newPlot(i,r,n,{responsive:!0}),10),i}onDelete(e,t=[]){return e?(t.length?H(e,t):Y(e),{date:e,entries:t}):{}}list(){const e=this.dates(),t=document.createElement("div");return t.append(...e.map(s=>{const r=A(s),n=document.createElement("div"),i=document.createElement("h3");i.style.marginBottom="0px",i.innerText=s;const a=document.createElement("small"),l=se(r);a.innerText=r.length?`${r.length} climbs @ V${l.toFixed(1)}`:"No Climbs";const d=ee({entries:r,onDelete:(u,h,w)=>this.onDelete(s,w)});return n.append(i,a,d),n})),t}render(){return[this.score,this.grades,this.list]}}let Ke="history-page";customElements.define(Ke,oe);const G=new ne,ie=new re,ce=new oe,We=new Q({header:"JustClimb",pages:[{label:"Score",element:G},{label:"History",element:ce},{label:"Settings",element:ie}]});document.body.append(We);p.add("scorePage",G);p.add("historyPage",ce);p.add("settingsPage",ie);p.add("$latestScoreView",function(){this.scorePage.score(this.latest)});p.add("$latestHistoryView",function(){this.historyPage.list(this.latest)});p.add("$historyScoreGlobal",function(){this.latest=G.history.latest});p.add("$rangeSliderGlobalRange",function(){this.range=this.settingsPage.onRangeUpdate()});p.add("$rangeLocalStorage",function(){this.range&&Z("gradeRange",this.range)});p.add("$rangeButtonsView",function(){this.range&&this.scorePage.buttons(this.range)});p.add("$onDeleteHistoryViewAndGlobal",function(){const o=R(),{date:e,entries:t}=this.historyPage.onDelete();e&&t&&(e===o&&(this.latest=t),this.historyPage.grades(!0),this.historyPage.score(!0))});
